<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.Dao.LabelDao">
    <!--根据labelid修改labelname-->
    <update id="changeLabelname">
        update label set labelname=#{labelname} where labelid=#{labelid}
    </update>

    <!--根据labelid设置是否删除了-->
    <update id="changeLabeldele">
        update label set labeldele=#{labeldele} where labelid=#{labelid}
    </update>

    <!--&lt;!&ndash;根据noteid改变所有该文件的标签删除状态&ndash;&gt;
    <update id="changeLabsOfNote" >
        update label set labeldele=#{labeldele} where noteid=#{noteid}
    </update>-->

    <!--根据noteid，删除该文件的所有lanrelationship-->
    <delete id="deleteLabsOfNote">
        delete from lanrelationship where nid=#{noteid}
    </delete>

    <!--根据noteid得到lid-->
    <select id="getlanLids" resultType="java.lang.Integer">
        select lid from lanrelationship where nid=#{noteid}
    </select>

    <!--根据多个lid，删除表中的相应的标签-->
    <delete id="deleteLabs">
        delete from label where labelid IN
        <foreach collection="libs" open="(" close=")" separator="," item="lib">
            #{lib}
        </foreach>
    </delete>

    <!--新建一个标签 -->
    <insert id="insertLabel" parameterType="com.Entity.Label">
        insert into label (labelid,labelname,labeldele,userid) values
        (#{label.labelid},#{label.labelname},#{label.labeldele},#{label.userid})
    </insert>

    <!--根据用户id查询该用户的所有标签,并且没有被删除-->
    <select id="getAllLabel" parameterType="java.lang.String" resultType="com.Entity.Label">
        select labelid,labelname from label where userid=#{userid} and labeldele ='no'
    </select>

    <!--根据文章id,查询该文章的所有标签-->
    <select id="getAllLabelOfNote" resultType="com.Entity.Label">
        select l.labelid,l.labelname from label l,lanrelationship lr where lr.lid=l.labelid and lr.nid= #{noteid}
    </select>
</mapper>